module picklr.aws.SecretsManager

import "../Resource.pkl"

/// A Secrets Manager Secret.
class Secret extends Resource.Resource {
  provider = "aws"

  /// The name of the secret.
  name: String

  /// The description of the secret.
  description: String?

  /// The KMS Key ID to encrypt the secret.
  kmsKeyId: String?

  properties = new {
    ["name"] = name
    ["description"] = description
    ["kms_key_id"] = kmsKeyId
  }
}

/// A Secrets Manager Secret Version.
class SecretVersion extends Resource.Resource {
  provider = "aws"

  /// The ID of the secret.
  secretId: String

  /// The secret string value.
  secretString: String

  properties = new {
    ["secret_id"] = secretId
    ["secret_string"] = secretString
  }
}

/// A Secrets Manager Resource Policy.
class SecretPolicy extends Resource.Resource {
  provider = "aws"
  
  /// The ARN of the secret that the resource policy attaches to.
  secretId: String
  
  /// A JSON-formatted string describing the resource policy.
  resourcePolicy: String
  
  /// Specifies whether to block resource-based policies that allow broad access to the secret.
  blockPublicPolicy: Boolean = true

  properties = new Mapping {
    ["secret_id"] = secretId
    ["resource_policy"] = resourcePolicy
    ["block_public_policy"] = blockPublicPolicy
  }
}
